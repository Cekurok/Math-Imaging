<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>difftools.fidop2d</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="difftools.myff2n" href="difftools.myff2n.html" />
    <link rel="prev" title="makeimg.gengrid" href="makeimg.gengrid.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span></span></a></h1>
        <h2 class="heading"><span>difftools.fidop2d</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="makeimg.gengrid.html">makeimg.gengrid</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="difftools.myff2n.html">difftools.myff2n</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="difftools-fidop2d">
<h1>difftools.fidop2d<a class="headerlink" href="#difftools-fidop2d" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="difftools.fidop2d">
<code class="descclassname">difftools.</code><code class="descname">fidop2d</code><span class="sig-paren">(</span><em>N</em>, <em>drt='xy'</em>, <em>fds='c'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/difftools.html#fidop2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#difftools.fidop2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute 2D finite difference operators</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>N</strong> : int</p>
<blockquote>
<div><p>Positive integer holding the grid dimension (has to be square, i.e.
<cite>N</cite>-by-<cite>N</cite>!)</p>
</div></blockquote>
<p><strong>drt</strong> : str</p>
<blockquote>
<div><p>String determining the direction of the discrete derivatives. 
Can be either &#8216;x&#8217;, &#8216;y&#8217; or &#8216;xy&#8217;.</p>
</div></blockquote>
<p><strong>fds</strong> : str</p>
<blockquote>
<div><p>String determining the employed finite difference scheme. Can be 
either &#8216;c&#8217; for centered, &#8216;f&#8217; for forward or &#8216;b&#8217; for backward.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>D</strong> : SciPy sparse matrix/matrices</p>
<blockquote class="last">
<div><p>Depending on the given input one or two sparse matrices 
corresponding to the wanted discrete derivative operators are 
returned.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For clarity here some comments on the rationale behind the code.</p>
<p><em>The Laplacian</em></p>
<p>If <cite>Dxf</cite> and <cite>Dyf</cite> are computed using forward differences, i.e.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dxf</span><span class="p">,</span><span class="n">Dyf</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>then the discrete Laplacian <cite>Lh</cite> based on centered differences is
obtained by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Lh</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Dxf</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dxf</span> <span class="o">+</span> <span class="n">Dyf</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dyf</span><span class="p">)</span>
</pre></div>
</div>
<p>or analogously for backward differences,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dxb</span><span class="p">,</span><span class="n">Dyb</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>then</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Lh</span> <span class="o">=</span> <span class="n">Dxb</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dxb</span> <span class="o">+</span> <span class="n">Dyb</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dyb</span>
</pre></div>
</div>
<p><em>The Divergence</em></p>
<p>Note adjoints: for <span class="math">\(p\)</span> in 
<span class="math">\(H_0(\mathrm{div}):=\{p \in L^2(\Omega)\)</span> | div <span class="math">\((p) \in L^2(\Omega), pn = 0\)</span> 
on the boundary of <span class="math">\(\Omega\}\)</span> we have</p>
<div class="math">
\[\begin{split}\begin{align}
\int_{\Omega} \nabla u\cdot p dx &amp;=  \int_{\Omega} u p \cdot  n dS - \int_{\Omega} u \textrm{ div }(p) dx\\
                              &amp; = 0 -\int_{\Omega} u \textrm{ div }(p) dx
\end{align}\end{split}\]</div>
<p>or in short <span class="math">\(\textrm{div}^\ast = -\nabla\)</span>. Hence for a spatial discretization take 
<cite>Div_h ~ -Dh.T</cite> as approximation for the divergence.</p>
<p class="rubric">Examples</p>
<p>The command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> 
</pre></div>
</div>
<p>returns the sparse <cite>N**2</cite>-by-<cite>N**2</cite> matrices <cite>Dx</cite> and <cite>Dy</cite> such that <cite>Dh</cite> defined by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span><span class="p">])</span>
</pre></div>
</div>
<p>is the discrete gradient operator in lexicographic 
ordering for a function <cite>F</cite> given on a grid of size <cite>N</cite>-by-<cite>N</cite>.
The matrix <cite>Dx</cite> is a discrete approximation of the first-order derivative operator 
in <cite>x</cite>-direction, Analogously, <cite>Dy</cite> discretizes the first order derivative operator 
in <cite>y</cite>-direction. The spacing between points in each direction is assumed to be one 
(i.e. the step size <cite>h = 1</cite>).</p>
<p>The command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">drt</span><span class="p">)</span> 
</pre></div>
</div>
<p>returns the sparse <cite>N**2</cite>-by-<cite>N**2</cite> matrix <cite>D</cite> corresponding to the discrete derivative 
operator in direction <cite>drt</cite> in lexicographic ordering. The string <cite>drt</cite> has to be either &#8216;x&#8217; (default)
, &#8216;y&#8217; or &#8216;xy&#8217;. Note: only &#8216;xy&#8217; will return two matrices, namely <cite>Dx</cite>, <cite>Dy</cite>.</p>
<p>The command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">drt</span><span class="p">,</span><span class="n">fds</span><span class="p">)</span> 
</pre></div>
</div>
<p>returns sparse the <cite>N**2</cite>-by-<cite>N**2</cite> matrix <cite>D</cite> corresponding to the discrete derivative 
operator in direction <cite>drt</cite> in lexicographic ordering using the finite difference scheme <cite>fds</cite>. 
The string <cite>fds</cite> can either be &#8216;c&#8217; (centered differences, in cells, default), 
&#8216;f&#8217; (forward differences, in interfaces) or &#8216;b&#8217; (backward differences, in interfaces).</p>
<p>To discretize first order differential operators on a 4-by-4 grid in both <cite>x</cite>- and <cite>y</cite>-directions 
using forward differences use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">fds</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To get only the discrete first order differential operator in <cite>y</cite>-direction on a grid of size <cite>N</cite> use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dy</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="makeimg.gengrid.html">makeimg.gengrid</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="difftools.myff2n.html">difftools.myff2n</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2017, Stefan Fuertinger.
      Last updated on Sep 21, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>