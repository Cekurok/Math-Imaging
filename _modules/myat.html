<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>myat</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span></span></a></h1>
        <h2 class="heading"><span>myat</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for myat</h1><div class="highlight"><pre>
<span></span><span class="c1"># myat.py - Implementation of an Ambrosio-Tortorelli segmentation</span>
<span class="c1"># </span>
<span class="c1"># Author: Stefan Fuertinger [stefan.fuertinger@gmx.at]</span>
<span class="c1"># Created: August 22 2012</span>
<span class="c1"># Last modified: &lt;2017-09-14 11:08:26&gt;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="k">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">spdiags</span><span class="p">,</span> <span class="n">linalg</span>

<span class="kn">from</span> <span class="nn">difftools</span> <span class="k">import</span> <span class="n">fidop2d</span>

<span class="c1">##########################################################################################</span>
<div class="viewcode-block" id="myat"><a class="viewcode-back" href="../_stubs/myat.myat.html#myat.myat">[docs]</a><span class="k">def</span> <span class="nf">myat</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">ep</span><span class="p">,</span><span class="n">nu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">de</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">la</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span><span class="n">itmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">iplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">Dx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Dy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Lh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve the Ambrosio--Tortorelli approximation of the Mumford--Shah functional</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : NumPy 2darray</span>
<span class="sd">        Raw (noisy) input image to be segmented. Note that `f` has to be square!</span>
<span class="sd">    ep : float</span>
<span class="sd">        Positive edge-&quot;thickness&quot; parameter in the approximation functional. For `ep -&gt; 0`</span>
<span class="sd">        the Ambrosio--Tortorelli approximation Gamma-converges to the Mumford--Shah </span>
<span class="sd">        functional (see Notes below). </span>
<span class="sd">    nu : float</span>
<span class="sd">        Positive parameter determining the influence of the Ambrosio--Tortorelli terms in the </span>
<span class="sd">        functional. </span>
<span class="sd">    de : float</span>
<span class="sd">        Positive parameter influencing the smoothness regularization term for `u` in the functional. </span>
<span class="sd">    la : float</span>
<span class="sd">        Positive parameter weighing the data fidelity term in the functional. </span>
<span class="sd">    tol : float</span>
<span class="sd">        Error tolerance for the stopping criterion satisfying `0 &lt; tol &lt;&lt; 1`. </span>
<span class="sd">    itmax : int</span>
<span class="sd">        Integer, the maximal number of iterations. </span>
<span class="sd">    iplot : bool</span>
<span class="sd">        Switch to turn interactive plotting on (`iplot=True`) or off (`iplot=False`)</span>
<span class="sd">    Dx : NumPy/SciPy matrix</span>
<span class="sd">        Disrecte derivative operator in direction `x` (foward differences are recommended). </span>
<span class="sd">        Note that if `f` is `N`-by-`N` then `Dx` has to be `N**2`-by-`N**2`!</span>
<span class="sd">    Dy : NumPy/SciPy matrix</span>
<span class="sd">        Discrete derivative operator in direction `y` (forward differences are recommended). </span>
<span class="sd">        Note that if `f` is `N`-by-`N` then `Dy` has to be `N**2`-by-`N**2`!</span>
<span class="sd">    Lh : NumPy/SciPy matrix</span>
<span class="sd">        Discrete Laplace operator (central differences are recommended). </span>
<span class="sd">        Note that if `f` is `N`-by-`N` then `Dy` has to be `N**2`-by-`N**2`!</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    u : NumPy 2darray</span>
<span class="sd">        The smoothed version of `f`. </span>
<span class="sd">    v : NumPy 2darray</span>
<span class="sd">        The fuzzy edge map of `f`. </span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The Ambrosio--Tortorelli functional [1]_ is given by </span>

<span class="sd">    .. math:: </span>

<span class="sd">       J_{\\varepsilon}[u,v] = \\int_{\\Omega}\\frac{\\nu\\varepsilon}{2}|\\nabla v|^2 + \\frac{\\nu}{2\\varepsilon}(1-v)^2 + \\frac{\\delta}{2} v^2|\\nabla u|^2 + \\frac{\\lambda}{2} (u-f)^2 dx</span>

<span class="sd">    The associated Euler--Lagrange equations are</span>

<span class="sd">    .. math::</span>

<span class="sd">       \\begin{align}</span>
<span class="sd">       -\\delta \\mathrm{div}(v^2 \\nabla u) + \\lambda u &amp;= \\lambda f \\\\</span>
<span class="sd">       \\frac{\\partial u}{\\partial n} &amp;= 0</span>
<span class="sd">       \\end{align}</span>

<span class="sd">    and</span>

<span class="sd">    .. math::</span>

<span class="sd">       \\begin{align}</span>
<span class="sd">       -\\nu\\varepsilon\\Delta v + \\frac{\\nu}{\\varepsilon}v + \\delta v|\\nabla u|^2 &amp;= \\frac{\\nu}{\\varepsilon} \\\\</span>
<span class="sd">       \\frac{\\partial u}{\\partial n} &amp;= 0</span>
<span class="sd">       \\end{align}</span>

<span class="sd">    The alternate optimization algorithm is initialized using</span>

<span class="sd">    .. math::</span>

<span class="sd">       \\begin{align}</span>
<span class="sd">       u_0 &amp;= f \\\\</span>
<span class="sd">       v_0 &amp;= 1/(1 + \\delta \\frac{\\varepsilon}{\\nu} |\\nabla f|^2)</span>
<span class="sd">       \\end{align}</span>

<span class="sd">    It can be shown that :math:`J_{\\epsilon}` Gamma-converges to the Mumford--Shah functional </span>
<span class="sd">    for :math:`\\varepsilon \\rightarrow 0` (see, e.g., [2]_). </span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] L. Ambrosio and V.M. Tortorelli. Approximation of functionals depending on</span>
<span class="sd">           jumps by elliptic functionals via Gamma-convergence. Communications on Pure and</span>
<span class="sd">           Applied Mathematics, 43:999-1036, 1990.</span>

<span class="sd">    .. [2] G. Aubert and P. Kornprobst: &quot;Mathematical Problems in Image Processing: Partial Differential </span>
<span class="sd">           Equations and the Calculus of Variations&quot;, Springer 2006. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Sanity checks</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s2">&quot;ndarray&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;f has to be a (square) NumPy 2darray!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;f has to be 2-dimensional!&quot;</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">M</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;f has to be square!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">N</span><span class="o">!=</span><span class="n">M</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;f has to be square!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;f must be real and must not contain NaNs or Infs!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">ep</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;ep has to be a positive float!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ep</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ep has to be &gt; 0!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">nu</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;nu has to be a positive float!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nu</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nu has to be &gt; 0!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">de</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;de has to be a positive float!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">de</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;de has to be &gt; 0!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">la</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;la has to be a positive float!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">la</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;la has to be &gt; 0!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">tol</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;tol has to be a positive integer!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tol</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;tol has to be &lt;&lt; 1!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="n">itmax</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;itmax has to be a positive integer!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">itmax</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;itmax has to be &gt;= 1!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span> <span class="o">!=</span> <span class="n">itmax</span><span class="p">:</span>
        <span class="n">itmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">&quot;WARNING: itmax has to be an integer - using round(itmax) = &quot;</span><span class="p">,</span><span class="n">itmax</span><span class="p">,</span><span class="s2">&quot; now...&quot;</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The switch `iplot` has to be Boolean!&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bad</span> <span class="o">=</span> <span class="p">(</span><span class="n">iplot</span> <span class="o">!=</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">iplot</span> <span class="o">!=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bad</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Dx</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">Dy</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">Dx</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">Dy</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;WARNING: Dx or Dy not provided, switching to default Dx and Dy&quot;</span>
        <span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Lh</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Dx</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;WARNING: Dx and Dy given but not Lh - using defaults for Dx and Dy. Lh will be computed as -(Dx.T*Dx + Dy.T*Dy)&quot;</span>
        <span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Dx</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">Dy</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Dx</span><span class="p">,</span><span class="n">Dy</span> <span class="o">=</span> <span class="n">fidop2d</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Dx</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;matrix&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Dx has to be a SciPy/Numpy matrix!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NN</span> <span class="o">=</span> <span class="n">Dx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">NN</span> <span class="o">!=</span> <span class="n">Dx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dx has to be a square matrix!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">NN</span> <span class="o">!=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dx has to be of dimension </span><span class="si">%s</span><span class="s2">**2 = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Dy</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;matrix&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Dy has to be a SciPy/NumPy matrix!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NN</span> <span class="o">=</span> <span class="n">Dy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">NN</span> <span class="o">!=</span> <span class="n">Dy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dy has to be a square matrix!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">NN</span> <span class="o">!=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dy has to be of dimension </span><span class="si">%s</span><span class="s2">**2 = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        
    <span class="k">if</span> <span class="n">Lh</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Lh</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;matrix&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Lh has to be a SciPy/NumPy matrix!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NN</span> <span class="o">=</span> <span class="n">Lh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">NN</span> <span class="o">!=</span> <span class="n">Lh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lh has to be a square matrix!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">NN</span> <span class="o">!=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lh has to be of dimension </span><span class="si">%s</span><span class="s2">**2 = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Lh</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Dx</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dx</span> <span class="o">+</span> <span class="n">Dy</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dy</span><span class="p">)</span>

    <span class="c1"># Get squared image dimension</span>
    <span class="n">NN</span> <span class="o">=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Allocate memory for u and v</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># Initial guess for u</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Initial guess for v</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">de</span><span class="o">*</span><span class="n">ep</span><span class="o">/</span><span class="n">nu</span><span class="o">*</span><span class="p">((</span><span class="n">Dx</span><span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Dy</span><span class="o">*</span><span class="n">f</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Convert u,v and f to vectors</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Set up plotting stuff if necessary</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iplot</span><span class="p">):</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">getfig</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">de</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">ep</span><span class="p">)</span>

    <span class="c1"># Show initial guess(es)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iplot</span><span class="p">):</span> <span class="n">showit</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># Initialize iteration parameters</span>
    <span class="n">it</span>    <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">rerru</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rerrv</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rerr</span>  <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">tol</span>
    <span class="n">Jold</span>  <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nfo</span>   <span class="o">=</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span><span class="s1">&#39;dec&#39;</span>
    <span class="n">ep1</span>   <span class="o">=</span> <span class="mf">1.0e-6</span>

    <span class="c1"># Allocate memory for right-hand-sides, iterates and the constant matrix</span>
    <span class="n">rhsv</span> <span class="o">=</span> <span class="n">nu</span><span class="o">/</span><span class="n">ep</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">NN</span><span class="p">,))</span>
    <span class="n">rhsu</span> <span class="o">=</span> <span class="n">la</span><span class="o">*</span><span class="n">f</span>
    <span class="n">Dla</span>  <span class="o">=</span> <span class="n">spdiags</span><span class="p">(</span><span class="n">la</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">NN</span><span class="p">,)),</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
    <span class="n">un</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">vn</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">JN</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NN</span><span class="p">,))</span>

    <span class="c1"># Allocate non-zero structure of varying matrices</span>
    <span class="n">Av</span> <span class="o">=</span> <span class="n">Lh</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Au</span> <span class="o">=</span> <span class="n">Dx</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dx</span>
    <span class="n">Dv</span> <span class="o">=</span> <span class="n">spdiags</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">NN</span><span class="p">,)),</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>

    <span class="c1"># The fpi-loop</span>
    <span class="k">while</span> <span class="n">rerr</span> <span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">it</span> <span class="o">&lt;=</span> <span class="n">itmax</span><span class="p">:</span>

        <span class="c1"># Update iteration counter</span>
        <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Compute new v</span>
        <span class="n">Av</span> <span class="o">=</span> <span class="n">spdiags</span><span class="p">(</span><span class="n">de</span><span class="o">*</span><span class="p">((</span><span class="n">Dx</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Dy</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">nu</span><span class="o">/</span><span class="n">ep</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span> <span class="o">-</span> <span class="n">nu</span><span class="o">*</span><span class="n">ep</span><span class="o">*</span><span class="n">Lh</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">spsolve</span><span class="p">(</span><span class="n">Av</span><span class="o">.</span><span class="n">tocsr</span><span class="p">(),</span><span class="n">rhsv</span><span class="p">)</span>
        
        <span class="c1"># Compute new u</span>
        <span class="n">Dv</span> <span class="o">=</span> <span class="n">spdiags</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">NN</span><span class="p">,</span><span class="n">NN</span><span class="p">)</span>
        <span class="n">Au</span> <span class="o">=</span> <span class="n">de</span><span class="o">*</span><span class="n">Dx</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dv</span><span class="o">*</span><span class="n">Dx</span> <span class="o">+</span> <span class="n">de</span><span class="o">*</span><span class="n">Dy</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Dv</span><span class="o">*</span><span class="n">Dy</span> <span class="o">+</span> <span class="n">Dla</span>
        <span class="n">un</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">spsolve</span><span class="p">(</span><span class="n">Au</span><span class="o">.</span><span class="n">tocsr</span><span class="p">(),</span><span class="n">rhsu</span><span class="p">)</span>

        <span class="c1"># Compute value of cost</span>
        <span class="n">JN</span> <span class="o">=</span> <span class="n">nu</span><span class="o">*</span><span class="n">ep</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Dx</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Dy</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">nu</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">ep</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> \
            <span class="o">+</span> <span class="n">de</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Dx</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">Dy</span><span class="o">*</span><span class="n">u</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">la</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">J</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">JN</span><span class="p">)</span>

        <span class="c1"># Compute relative errors</span>
        <span class="n">rerru</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">un</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">un</span> <span class="o">+</span> <span class="n">ep1</span><span class="p">))</span>
        <span class="n">rerrv</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">vn</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">vn</span> <span class="o">+</span> <span class="n">ep1</span><span class="p">))</span>
        <span class="n">rerr</span>  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rerru</span><span class="p">,</span><span class="n">rerrv</span><span class="p">)</span>
    
        <span class="c1"># Show info in prompt</span>
        <span class="nb">print</span> <span class="s2">&quot;it = </span><span class="si">%s</span><span class="s2">, rerr = </span><span class="si">%s</span><span class="s2">, J = </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">it</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">rerr</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">nfo</span><span class="p">[</span><span class="n">Jold</span><span class="o">&gt;</span><span class="n">J</span><span class="p">])</span>

        <span class="c1"># Update iterates and cost</span>
        <span class="n">u</span>    <span class="o">=</span> <span class="n">un</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">v</span>    <span class="o">=</span> <span class="n">vn</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">Jold</span> <span class="o">=</span> <span class="n">J</span>

        <span class="c1"># Plot intermediate results every mplot steps</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">iplot</span><span class="p">):</span> <span class="n">showit</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># Show final results</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iplot</span><span class="p">):</span> <span class="n">showit</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># Convert u and v back to images</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span></div>

<span class="c1">##########################################################################################</span>
<span class="k">def</span> <span class="nf">getfig</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">de</span><span class="p">,</span><span class="n">la</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">ep</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set up Figure for interactive plotting</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set up figure and assign window- and sup-title</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_window_title</span><span class="p">(</span><span class="s2">&quot;Ambrosio-Tortorelli&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\delta = </span><span class="si">%s</span><span class="s1">,\quad \lambda = </span><span class="si">%s</span><span class="s1">,\quad \nu = </span><span class="si">%s</span><span class="s1">,\quad \varepsilon = </span><span class="si">%s</span><span class="s1">$&#39;</span>\
                        <span class="o">%</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">de</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">la</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">nu</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="n">ep</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c1"># Get image dimension</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Plot original image f</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$f$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="c1">##########################################################################################</span>
<span class="k">def</span> <span class="nf">showit</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Show iteration process</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get image dimension</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Plot u</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$u$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="c1"># Plot v</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$v$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2017, Stefan Fuertinger.
      Last updated on Sep 21, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>