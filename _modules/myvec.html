<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>myvec</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span></span></a></h1>
        <h2 class="heading"><span>myvec</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for myvec</h1><div class="highlight"><pre>
<span></span><span class="c1"># myvec.py - Plotting tools for vector fields</span>
<span class="c1"># </span>
<span class="c1"># Author: Stefan Fuertinger [stefan.fuertinger@gmx.at]</span>
<span class="c1"># Created: June 13 2012</span>
<span class="c1"># Last modified: &lt;2017-09-21 12:41:45&gt;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">griddata</span>

<span class="c1">##########################################################################################</span>
<div class="viewcode-block" id="myquiv"><a class="viewcode-back" href="../_stubs/myvec.myquiv.html#myvec.myquiv">[docs]</a><span class="k">def</span> <span class="nf">myquiv</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a 2D vector field using &quot;sane&quot; defaults for Matplotlib&#39;s `quiver`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    u : NumPy 2darray</span>
<span class="sd">        `x` components of the vector field `w(x,y) = (u(x,y),v(x,y))`. Note that `u` has to be </span>
<span class="sd">        a 2D array of the same dimension as `v`. </span>
<span class="sd">    v : NumPy 2darray</span>
<span class="sd">        `y` components of the vector field `w(x,y) = (u(x,y),v(x,y))`. Note that `v` has to be </span>
<span class="sd">        a 2D array of the same dimension as `u`. </span>
<span class="sd">       </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Nothing : None </span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    quiver : in the `Matplotlib Example Code Repository &lt;http://matplotlib.org/examples/pylab_examples/quiver_demo.html&gt;`_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check the input vector field</span>
    <span class="n">checkfield</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">varnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span><span class="s2">&quot;v&quot;</span><span class="p">])</span>

    <span class="c1"># Now do something</span>
    <span class="n">N</span>  <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dN</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="n">dN</span><span class="p">),</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">:(</span><span class="n">N</span><span class="o">/</span><span class="n">dN</span><span class="p">)],</span><span class="n">u</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="n">dN</span><span class="p">),</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">:(</span><span class="n">N</span><span class="o">/</span><span class="n">dN</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">return</span></div>

<span class="c1">##########################################################################################</span>
<div class="viewcode-block" id="makegrid"><a class="viewcode-back" href="../_stubs/myvec.makegrid.html#myvec.makegrid">[docs]</a><span class="k">def</span> <span class="nf">makegrid</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">xmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ymin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an `M`-by-`N` grid on the 2D-domain `[xmin,xmax]`-by-`[ymin,ymax]`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N : int</span>
<span class="sd">        The number of grid-points in vertical (i.e. `y`-) direction</span>
<span class="sd">    M : int </span>
<span class="sd">        The number of grid-points in horizontal (i.e. `x`-) direction. By default `M = N`</span>
<span class="sd">    xmin : float</span>
<span class="sd">        The left boundary of the (rectangular) domain. By default `xmin = 1` </span>
<span class="sd">    xmax : float</span>
<span class="sd">        The right boundary of the (rectangular) domain. By default `xmax = N`</span>
<span class="sd">    ymin : float</span>
<span class="sd">        The lower boundary of the (rectangular) domain. By default `ymin = 1`</span>
<span class="sd">    ymax : float</span>
<span class="sd">        The upper boundary of the (rectangular) domain. By default `ymax = N`</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x : NumPy 2darray</span>
<span class="sd">        2D grid array of `x`-values on the domain `[xmin,xmax]`-by-`[ymin,ymax]`</span>
<span class="sd">    y : NumPy 2darray</span>
<span class="sd">        2D grid array of `y`-values on the domain `[xmin,xmax]`-by-`[ymin,ymax]`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The call</span>
<span class="sd"> </span>
<span class="sd">    &gt;&gt;&gt; x,y = makegrid(N)</span>

<span class="sd">    creates a square `[1,N]`-by-`[1,N]` grid given by</span>

<span class="sd">    &gt;&gt;&gt; x</span>
<span class="sd">        array([[   1.,    1.,    1., ...,    1.],</span>
<span class="sd">               [   2.,    2.,    2., ...,    2.],</span>
<span class="sd">               ..., </span>
<span class="sd">               [    N,     N,     N, ...,     N]])</span>

<span class="sd">    and</span>

<span class="sd">    &gt;&gt;&gt; y</span>
<span class="sd">        array([[   1.,    2.,    3., ...,     N],</span>
<span class="sd">               [   1.,    2.,    3., ...,     N],</span>
<span class="sd">               ..., </span>
<span class="sd">               [   1.,    2.,    3., ...,     N]])</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    meshgrid : NumPy&#39;s `meshgrid &lt;http://docs.scipy.org/doc/numpy/reference/generated/numpy.meshgrid.html&gt;`_</span>
<span class="sd">    gengrid : found in the module `makeimg &lt;makeimg.gengrid.html&gt;`_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Sanity checks</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="s2">&quot;xmin&quot;</span><span class="p">)</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span><span class="s2">&quot;xmax&quot;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="s2">&quot;ymin&quot;</span><span class="p">)</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span><span class="s2">&quot;ymax&quot;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="n">ymin</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>

    <span class="c1"># Compute stepsizes</span>
    <span class="n">hx</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">hy</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Build 1D grid arrays</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">+</span> <span class="n">hx</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">M</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">hy</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>

    <span class="c1"># Build 2D grid arrays</span>
    <span class="n">y</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span></div>

<span class="c1">##########################################################################################</span>
<div class="viewcode-block" id="mygrid"><a class="viewcode-back" href="../_stubs/myvec.mygrid.html#myvec.mygrid">[docs]</a><span class="k">def</span> <span class="nf">mygrid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rowstep</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">colstep</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;lanczos&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a 2D vector field as deformed grid on a 2D lattice</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    u : NumPy 2darray</span>
<span class="sd">        `x` components of the vector field `w(x,y) = (u(x,y),v(x,y))`. Note that `u` has to be </span>
<span class="sd">        a 2D array of the same dimension as `v`. </span>
<span class="sd">    v : NumPy 2darray</span>
<span class="sd">        `y` components of the vector field `w(x,y) = (u(x,y),v(x,y))`. Note that `v` has to be </span>
<span class="sd">        a 2D array of the same dimension as `u`. </span>
<span class="sd">    x : NumPy 2darray</span>
<span class="sd">        2D grid array of `x`-values on the domain of `w(x,y)`. By default it is assumed that </span>
<span class="sd">        `w` is defined on `[1,N]`-by-`[1,N]` </span>
<span class="sd">    y : NumPy 2darray</span>
<span class="sd">        2D grid array of `y`-values on the domain of `w(x,y)`. By default it is assumed that </span>
<span class="sd">        `w` is defined on `[1,N]`-by-`[1,N]` </span>
<span class="sd">    rowstep : int</span>
<span class="sd">        Array row stride (step size) used to generate the grid. Default value is 16. </span>
<span class="sd">    colstep : int</span>
<span class="sd">        Array column stride (step size) used to generate the grid. Default value is 16. </span>
<span class="sd">    interpolation : str</span>
<span class="sd">        Interpolation to be used for plotting. Default value is &quot;lanczos&quot;. </span>
<span class="sd">        Recommended other values are &quot;bilinear&quot; or &quot;nearest&quot;. See Matplotlib&#39;s </span>
<span class="sd">        `imshow`-documentation for details. </span>
<span class="sd">       </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Nothing : None </span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    imshow : in the `Matplotlib documentation &lt;http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow&gt;`_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check the input vector field</span>
    <span class="n">checkfield</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">varnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span><span class="s2">&quot;v&quot;</span><span class="p">])</span>
    <span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Check the grid</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;WARNING: Only x- or y-grid-data specified - switching to default domain `[1,N]`-by-`[1,N]`...&quot;</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">makegrid</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">makegrid</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">checkfield</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">varnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
        <span class="n">checkgrid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Sanity checks</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">rowstep</span><span class="p">,</span><span class="s2">&quot;rowstep&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">colstep</span><span class="p">,</span><span class="s2">&quot;colstep&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interpolation</span><span class="p">,(</span><span class="nb">str</span><span class="p">,</span><span class="n">unicode</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input `interpolation` has to be a string!&#39;</span><span class="p">)</span>

    <span class="c1"># Create lattice</span>
    <span class="n">wires</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">wires</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">rowstep</span><span class="p">,:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">wires</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">colstep</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Apply vector field</span>
    <span class="n">zipyx</span>  <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">wiresr</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">zipyx</span><span class="p">,</span><span class="n">wires</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">),(</span><span class="n">y</span><span class="o">+</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="n">u</span><span class="p">),</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># Plot it</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wiresr</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">return</span></div>

<span class="c1">##########################################################################################</span>
<div class="viewcode-block" id="mywire"><a class="viewcode-back" href="../_stubs/myvec.mywire.html#myvec.mywire">[docs]</a><span class="k">def</span> <span class="nf">mywire</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rowstep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">colstep</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a 2D vector field as 3D wire-frame using Matplotlib&#39;s `plot_wireframe`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    u : NumPy 2darray</span>
<span class="sd">        `x` components of the vector field `w(x,y) = (u(x,y),v(x,y))`. Note that `u` has to be </span>
<span class="sd">        a 2D array of the same dimension as `v`. </span>
<span class="sd">    v : NumPy 2darray</span>
<span class="sd">        `y` components of the vector field `w(x,y) = (u(x,y),v(x,y))`. Note that `v` has to be </span>
<span class="sd">        a 2D array of the same dimension as `u`. </span>
<span class="sd">    x : NumPy 2darray</span>
<span class="sd">        2D grid array of `x`-values on the domain of `w(x,y)`. By default it is assumed that </span>
<span class="sd">        `w` is defined on `[1,N]`-by-`[1,N]` </span>
<span class="sd">    y : NumPy 2darray</span>
<span class="sd">        2D grid array of `y`-values on the domain of `w(x,y)`. By default it is assumed that </span>
<span class="sd">        `w` is defined on `[1,N]`-by-`[1,N]` </span>
<span class="sd">    rowstep : int</span>
<span class="sd">        Array row stride (step size) used to generate the wire-frame plot (see `plot_wireframe`&#39;s </span>
<span class="sd">        documentation for details). Default value is 1. </span>
<span class="sd">    colstep : int</span>
<span class="sd">        Array column stride (step size) used to generate the wire-frame plot (see `plot_wireframe`&#39;s </span>
<span class="sd">        documentation for details). Default value is 1. </span>
<span class="sd">       </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Nothing : None </span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    plot_wireframe : in the `Matplotlib documentation &lt;http://matplotlib.org/mpl_toolkits/mplot3d/api.html#mpl_toolkits.mplot3d.axes3d.Axes3D.plot_wireframe&gt;`_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check the input vector field</span>
    <span class="n">checkfield</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">varnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span><span class="s2">&quot;v&quot;</span><span class="p">])</span>
    <span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Check the grid</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;WARNING: Only x- or y-grid-data specified - switching to default domain `[1,N]`-by-`[1,N]`...&quot;</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">makegrid</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">makegrid</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">checkfield</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">varnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
        <span class="n">checkgrid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Sanity checks</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">rowstep</span><span class="p">,</span><span class="s2">&quot;rowstep&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">scalarcheck</span><span class="p">(</span><span class="n">colstep</span><span class="p">,</span><span class="s2">&quot;colstep&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

    <span class="c1"># Draw the deformed grid</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="o">+</span><span class="n">v</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">rstride</span><span class="o">=</span><span class="n">rowstep</span><span class="p">,</span><span class="n">cstride</span><span class="o">=</span><span class="n">colstep</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

    <span class="k">return</span></div>

<span class="c1">##########################################################################################</span>
<span class="k">def</span> <span class="nf">checkfield</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">varnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;u&quot;</span><span class="p">,</span><span class="s2">&quot;v&quot;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform sanity checks on the input vector field</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">for</span> <span class="n">nk</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">]):</span>
        <span class="n">varname</span> <span class="o">=</span> <span class="n">varnames</span><span class="p">[</span><span class="n">nk</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sha</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input `&#39;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s1">&#39;` must be a NumPy array, not &#39;</span><span class="o">+</span><span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="o">+</span><span class="s1">&#39;!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sha</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Input `&#39;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s1">&#39;` must be a `M`-by-`N` NumPy array&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">sha</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="n">sha</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Input `&#39;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s1">&#39;` must be a `M`-by-`N` NumPy array!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plt</span><span class="o">.</span><span class="n">is_numlike</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Input `&#39;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s1">&#39;` must be a real-valued `M`-by-`N` NumPy array!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Input `&#39;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s1">&#39;` must be a real valued NumPy array without Infs or NaNs!&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Inputs `&quot;</span><span class="o">+</span><span class="n">varnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;` and `&quot;</span><span class="o">+</span><span class="n">varnames</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;` must have the same dimension!&quot;</span><span class="p">)</span>
        
    <span class="k">return</span>

<span class="c1">##########################################################################################</span>
<span class="k">def</span> <span class="nf">checkgrid</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform sanity checks on the grid</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grid and vector field must have the same dimensions!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Grid and vector field must have the same dimensions!&quot;</span><span class="p">)</span>
        
    <span class="k">return</span>

<span class="c1">##########################################################################################</span>
<span class="k">def</span> <span class="nf">scalarcheck</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">varname</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Local helper function performing sanity checks on scalars</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">plt</span><span class="o">.</span><span class="n">is_numlike</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isreal</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input `&quot;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s2">&quot;` must be a real scalar!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Input `&quot;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s2">&quot;` must be finite!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">!=</span> <span class="n">val</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input `&quot;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s2">&quot;` must be an integer!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input scalar `&quot;</span><span class="o">+</span><span class="n">varname</span><span class="o">+</span><span class="s2">&quot;` must be between &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; and &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;!&quot;</span><span class="p">)</span>
</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2017, Stefan Fuertinger.
      Last updated on Sep 21, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>